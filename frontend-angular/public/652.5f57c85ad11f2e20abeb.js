(self.webpackChunkmbti_assessment_client_app=self.webpackChunkmbti_assessment_client_app||[]).push([[652],{4652:(e,t,i)=>{"use strict";i.r(t),i.d(t,{UserModule:()=>E});var s=i(7707),r=i(1462),n=i(1625),a=i(8699),l=i(3395),o=i(878),u=i(436),m=i(9996),d=i(7727),c=i(3888),g=i(5366),Z=i(5043);let p=(()=>{class e{constructor(e,t){this.actions$=e,this.userService=t,this.update$=(0,l.GW)(()=>this.actions$.pipe((0,l.l4)(c.T$),(0,u.b)(e=>this.userService.updateUser(e.userForm).pipe((0,m.U)(e=>(this.userService.updateUserInLocalCache(e),c.qN({user:e,notificationMsg:{header:"Profile Updating",body:"Your profile was successfully updated."}}))),(0,d.K)(e=>(0,o.of)(c.LC(e.error.message?{error:e.error.message}:{error:"An error occurred. Please try again."})))))))}}return e.\u0275fac=function(t){return new(t||e)(g.LFG(l.eX),g.LFG(Z.K))},e.\u0275prov=g.Yz7({token:e,factory:e.\u0275fac}),e})();var f=i(1671),h=i(5976),v=i(8376),A=i(7457),b=i(7311),q=i(5769),N=i(1116),T=i(701),U=i(4108),x=i(9877);function I(e,t){if(1&e&&(g.TgZ(0,"div",45),g.TgZ(1,"div",46),g._uU(2),g.qZA(),g.qZA()),2&e){const e=g.oxw(2);g.xp6(1),g.Udp("width",null==e.fileStatus?null:e.fileStatus.percentage,"%"),g.xp6(1),g.hij(" ",null==e.fileStatus?null:e.fileStatus.percentage,"% ")}}function y(e,t){if(1&e&&(g.TgZ(0,"div",47),g.TgZ(1,"small"),g._uU(2),g.ALo(3,"date"),g.qZA(),g.qZA()),2&e){const e=g.oxw().ngIf;g.xp6(2),g.hij("Last login: ",g.xi3(3,1,null==e?null:e.lastLoginDateDisplay,"medium"),"")}}function _(e,t){if(1&e&&(g.TgZ(0,"option",53),g._uU(1),g.qZA()),2&e){const e=t.$implicit;g.xp6(1),g.hij(" ",e.label," ")}}function k(e,t){if(1&e&&(g.TgZ(0,"select",50),g.TgZ(1,"option",51),g._uU(2),g.qZA(),g.YNc(3,_,2,1,"option",52),g.qZA()),2&e){const e=t.$implicit,i=g.oxw(3);g.xp6(2),g.Oqu(e.role),g.xp6(1),g.Q6J("ngForOf",i.roleOptions)}}function L(e,t){if(1&e&&(g.TgZ(0,"div",3),g.TgZ(1,"div",48),g.TgZ(2,"div",27),g.TgZ(3,"label",28),g._uU(4,"Role"),g.qZA(),g.YNc(5,k,4,2,"select",49),g.ALo(6,"async"),g.qZA(),g.qZA(),g.qZA()),2&e){const e=g.oxw(2);g.xp6(5),g.Q6J("ngIf",g.lcZ(6,1,e.user$))}}function C(e,t){1&e&&g._UZ(0,"i",54)}function S(e,t){1&e&&(g.TgZ(0,"span"),g._uU(1,"Loading..."),g.qZA())}function F(e,t){1&e&&(g.TgZ(0,"span"),g._uU(1,"Save Changes"),g.qZA())}const J=function(e,t){return{"is-invalid":e,"is-valid":t}};function w(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"div",1),g.TgZ(1,"div",2),g.TgZ(2,"div",3),g.TgZ(3,"div",4),g.TgZ(4,"div",5),g.TgZ(5,"div",6),g.TgZ(6,"div",7),g._UZ(7,"img",8),g.YNc(8,I,3,3,"div",9),g.TgZ(9,"div",10),g.TgZ(10,"h4"),g._uU(11),g.qZA(),g.TgZ(12,"p",11),g._uU(13),g.qZA(),g.YNc(14,y,4,4,"div",12),g.TgZ(15,"div",13),g.TgZ(16,"div",14),g.TgZ(17,"small"),g._uU(18),g.ALo(19,"date"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(20,"div",15),g.TgZ(21,"button",16),g.NdJ("click",function(){return g.CHM(e),g.oxw().updateProfileImage()}),g._UZ(22,"i",17),g.TgZ(23,"span"),g._uU(24,"\xa0 Change Photo"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(25,"div",15),g.TgZ(26,"button",18),g.NdJ("click",function(){return g.CHM(e),g.oxw().onLogout()}),g.TgZ(27,"span"),g._uU(28,"\xa0 Logout"),g.qZA(),g._UZ(29,"i",19),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(30,"div",20),g._UZ(31,"app-personality-info"),g.qZA(),g.qZA(),g.TgZ(32,"div",21),g.TgZ(33,"div",22),g.TgZ(34,"div",6),g.TgZ(35,"div",23),g.TgZ(36,"div",24),g.TgZ(37,"form",25),g.NdJ("ngSubmit",function(){return g.CHM(e),g.oxw().onSave()}),g.TgZ(38,"div",3),g.TgZ(39,"div",26),g.TgZ(40,"div",3),g.TgZ(41,"div",26),g.TgZ(42,"div",27),g.TgZ(43,"label",28),g._uU(44,"First Name"),g.qZA(),g._UZ(45,"input",29),g.qZA(),g.qZA(),g.TgZ(46,"div",26),g.TgZ(47,"div",27),g.TgZ(48,"label",28),g._uU(49," Last Name"),g.qZA(),g._UZ(50,"input",30),g.qZA(),g.qZA(),g.qZA(),g.TgZ(51,"div",3),g.TgZ(52,"div",26),g.TgZ(53,"div",27),g.TgZ(54,"label",28),g._uU(55,"Username"),g.qZA(),g._UZ(56,"input",31),g.qZA(),g.qZA(),g.qZA(),g.TgZ(57,"div",3),g.TgZ(58,"div",26),g.TgZ(59,"div",27),g.TgZ(60,"label",28),g._uU(61,"Email"),g.qZA(),g._UZ(62,"input",32),g.qZA(),g.qZA(),g.qZA(),g.YNc(63,L,7,3,"div",33),g.ALo(64,"async"),g.qZA(),g.qZA(),g.TgZ(65,"div",3),g.TgZ(66,"div",34),g.TgZ(67,"div",28),g.TgZ(68,"b"),g._uU(69,"Account Settings"),g.qZA(),g.qZA(),g.TgZ(70,"div",3),g.TgZ(71,"div",26),g.TgZ(72,"div",35),g.TgZ(73,"div",36),g._UZ(74,"input",37),g.TgZ(75,"label",38),g._uU(76," Active "),g.qZA(),g.qZA(),g.TgZ(77,"div",36),g._UZ(78,"input",39),g.TgZ(79,"label",40),g._uU(80," Non locked "),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(81,"div",3),g.TgZ(82,"div",41),g.TgZ(83,"button",42),g.YNc(84,C,1,0,"i",43),g._uU(85,"\xa0\xa0 "),g.YNc(86,S,2,0,"span",44),g.YNc(87,F,2,0,"span",44),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g._UZ(88,"app-score"),g.qZA(),g.qZA(),g.qZA(),g.qZA()}if(2&e){const e=t.ngIf,i=g.oxw();g.xp6(7),g.s9C("src",null==e?null:e.profileImageUrl,g.LSH),g.xp6(1),g.Q6J("ngIf","progress"===(null==i.fileStatus?null:i.fileStatus.status)),g.xp6(3),g.AsE("",null==e?null:e.firstName," ",null==e?null:e.lastName,""),g.xp6(2),g.Oqu(null==e?null:e.username),g.xp6(1),g.Q6J("ngIf",null!==(null==e?null:e.lastLoginDateDisplay)),g.xp6(4),g.hij("Joined ",g.xi3(19,17,null==e?null:e.joinDate,"mediumDate"),""),g.xp6(19),g.Q6J("formGroup",i.profileUserForm),g.xp6(8),g.Q6J("ngClass",g.WLB(22,J,i.isFirstNameInvalid,i.isFirstNameValid)),g.xp6(5),g.Q6J("ngClass",g.WLB(25,J,i.isLastNameInvalid,i.isLastNameValid)),g.xp6(6),g.Q6J("ngClass",g.WLB(28,J,i.isUsernameInvalid,i.isUsernameValid)),g.xp6(6),g.Q6J("ngClass",g.WLB(31,J,i.isEmailInvalid,i.isEmailValid)),g.xp6(1),g.Q6J("ngIf",g.lcZ(64,20,i.isAdmin$)),g.xp6(20),g.Q6J("disabled",i.profileUserForm.invalid),g.xp6(1),g.Q6J("ngIf",i.refreshing),g.xp6(2),g.Q6J("ngIf",i.refreshing),g.xp6(1),g.Q6J("ngIf",!i.refreshing)}}let $=(()=>{class e{constructor(e,t,i){this.formBuilder=e,this.storeAuth=t,this.storeMbti=i,this.namePattern="^[a-zA-Z]+(([' -][a-zA-Z ])?[a-zA-Z]*)*$",this.usernamePattern="^[a-z0-9_-]{5,15}$",this.passwordPattern="^(?=.*d)(?=.*[a-z])(?=.*[A-Z]).{8,15}$",this.emailPattern="^[a-z0-9._%+-]+@[a-z0-9.-]+.[a-z]{2,4}$",this.roleOptions=[{value:"USER",label:"USER"},{value:"ADMIN",label:"ADMIN"},{value:"SUPER_ADMIN",label:"SUPER_ADMIN"}]}ngOnInit(){this.user$=this.storeAuth.pipe((0,f.Ys)(v.dy)),this.isAdmin$=this.storeAuth.pipe((0,f.Ys)(v.yX)),this.onProfileUserFormError$=this.storeAuth.pipe((0,f.Ys)(v.Hn)),this.score$=this.storeMbti.pipe((0,f.Ys)(A.gA)),this.score$.subscribe(e=>{if(null===e){const e=JSON.parse(localStorage.getItem("user"));e&&this.storeMbti.dispatch(b.vJ({username:e.username}))}return e}),this.user$.subscribe(e=>{this.profileUserForm=this.formBuilder.group({firstName:[null==e?void 0:e.firstName,[r.kI.required,r.kI.minLength(3),r.kI.pattern(this.namePattern)]],lastName:[null==e?void 0:e.lastName,[r.kI.required,r.kI.minLength(3),r.kI.pattern(this.namePattern)]],username:[null==e?void 0:e.username,[r.kI.required,r.kI.minLength(5),r.kI.pattern(this.usernamePattern)]],email:[null==e?void 0:e.email,[r.kI.required,r.kI.pattern(this.emailPattern)]],role:[""],enabled:[{value:null==e?void 0:e.enabled,disabled:!this.isAdmin(e)}],nonLocked:[{value:null==e?void 0:e.nonLocked,disabled:!this.isAdmin(e)}]})})}onLogout(){this.storeAuth.dispatch(h.kS({notificationMsg:{header:"Logout Notification",body:"Successfully logged out.\n          See you !"}}))}onSave(){this.user$.subscribe(e=>this.currentUsername=e.username),this.storeAuth.dispatch(c.T$({userForm:{lastName:this.lastName.value,firstName:this.firstName.value,email:this.email.value,username:this.username.value,currentUsername:this.currentUsername,role:this.role.value,isEnabled:this.enabled.value,isNonLocked:this.nonLocked.value}}))}get firstName(){return this.profileUserForm.get("firstName")}get lastName(){return this.profileUserForm.get("lastName")}get username(){return this.profileUserForm.get("username")}get email(){return this.profileUserForm.get("email")}get role(){return this.profileUserForm.get("role")}get enabled(){return this.profileUserForm.get("enabled")}get nonLocked(){return this.profileUserForm.get("nonLocked")}get isFirstNameInvalid(){return this.firstName.invalid&&(this.firstName.dirty||this.firstName.touched)}get isFirstNameValid(){return this.firstName.valid&&(this.firstName.dirty||this.firstName.touched)}get isLastNameInvalid(){return this.lastName.invalid&&(this.lastName.dirty||this.lastName.touched)}get isLastNameValid(){return this.lastName.valid&&(this.lastName.dirty||this.lastName.touched)}get isUsernameInvalid(){return this.username.invalid&&(this.username.dirty||this.username.touched)}get isUsernameValid(){return this.username.valid&&(this.username.dirty||this.username.touched)}get isEmailInvalid(){return this.email.invalid&&(this.email.dirty||this.email.touched)}get isEmailValid(){return this.email.valid&&(this.email.dirty||this.email.touched)}isAdmin(e){return e?e.role===q.u.ADMIN||e.role===q.u.SUPER_ADMIN:null}}return e.\u0275fac=function(t){return new(t||e)(g.Y36(r.qu),g.Y36(f.yh),g.Y36(f.yh))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-profile"]],decls:2,vars:3,consts:[["class","container text-dark",4,"ngIf"],[1,"container","text-dark"],[1,"main-body"],[1,"row"],[1,"col-lg-4"],[1,"card"],[1,"card-body"],[1,"d-flex","flex-column","align-items-center","text-center"],["alt","Admin","width","135",1,"rounded-circle","p-1","bg-gray",3,"src"],["class","progress mt-1",4,"ngIf"],[1,"mt-3"],[1,"text-secondary","mb-1"],["class","text-muted mt-3 mb-2",4,"ngIf"],[1,"text-center","text-sm-right"],[1,"text-muted","mb-3"],[1,"center"],["type","button",1,"btn","btn-secondary","my-3",3,"click"],[1,"fa","fa-fw","fa-camera"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-sign-in-alt","ml-1"],[1,"mb-4"],[1,"col-lg-8"],[1,"card","mb-3"],[1,"tab-content","pt-3"],[1,"tab-pane","active"],["novalidate","",1,"form",3,"formGroup","ngSubmit"],[1,"col"],[1,"form-group"],[1,"my-2"],["type","text","maxlength","30","formControlName","firstName","placeholder","FirstName",1,"form-control",3,"ngClass"],["type","text","maxlength","30","formControlName","lastName","placeholder","LastName",1,"form-control",3,"ngClass"],["type","text","maxlength","30","formControlName","username","placeholder","Username",1,"form-control",3,"ngClass"],["type","text","maxlength","30","formControlName","email","placeholder","Email",1,"form-control",3,"ngClass"],["class","row",4,"ngIf"],[1,"col-12","col-sm-5","offset-sm-1","mb-3"],[1,"custom-controls-stacked","px-2"],[1,"form-check"],["mdbCheckbox","","formControlName","enabled","type","checkbox",1,"form-check-input"],["for","enabled",1,"form-check-label"],["mdbCheckbox","","formControlName","nonLocked","type","checkbox",1,"form-check-input"],["for","nonLocked",1,"form-check-label"],[1,"col","d-flex","justify-content-end"],["type","submit",1,"btn","btn-secondary",3,"disabled"],["class","fas fa-spinner fa-spin",4,"ngIf"],[4,"ngIf"],[1,"progress","mt-1"],["role","progressbar","aria-valuenow","75","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","bg-accent"],[1,"text-muted","mt-3","mb-2"],[1,"col","mb-3"],["formControlName","role","class","form-control",4,"ngIf"],["formControlName","role",1,"form-control"],["selected",""],["value","role.value",4,"ngFor","ngForOf"],["value","role.value"],[1,"fas","fa-spinner","fa-spin"]],template:function(e,t){1&e&&(g.YNc(0,w,89,34,"div",0),g.ALo(1,"async")),2&e&&g.Q6J("ngIf",g.lcZ(1,1,t.user$))},directives:[N.O5,T.P,r._Y,r.JL,r.sg,r.Fj,r.nD,r.JJ,r.u,N.mk,r.Wl,U.mI,x.k,r.EJ,r.YN,r.Kr,N.sg],pipes:[N.Ov,N.uU],styles:[".collapse[_ngcontent-%COMP%]{margin-top:-10px}hr[_ngcontent-%COMP%]{border:2px solid}"]}),e})();var Y=i(4154);const M=[{path:"profile",component:$}];let P=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.oAB({type:e}),e.\u0275inj=g.cJS({imports:[[Y.Bz.forChild(M)],Y.Bz]}),e})(),E=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.oAB({type:e}),e.\u0275inj=g.cJS({imports:[[r.u5,r.UX,a.s,s.MbtiModule,P,n.K,l.sQ.forFeature([p])]]}),e})()}}]);